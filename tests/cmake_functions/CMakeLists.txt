function(get_substr str begin length result)
    IF (begin LESS 0)
        STRING(LENGTH ${str} str_len)
        MATH(EXPR new_begin_pos '${str_len}${begin}')
        set(begin ${new_begin_pos})
    ENDIF(begin LESS 0)
    STRING(SUBSTRING ${str} ${begin} ${length} substr)
    set(${result} ${substr} PARENT_SCOPE)
endfunction()

function(join_paths path_head path_tail result)
    #STRING(LENGTH ${path_head} path_head_len)
    #MATH(EXPR path_head_last_char_pos '${path_head_len}-1')
    #STRING(SUBSTRING ${path_head} ${path_head_last_char_pos} 1 path_head_last_char)
    set(path_head_last_char "")
    get_substr(path_head -1 1 path_head_last_char)
    STRING(COMPARE NOTEQUAL ${path_head_last_char} "/" no_ending_slash)
    set(path_tail_first_char "")
    get_substr(path_tail 0 1 path_tail_first_char)
    STRING(COMPARE NOTEQUAL ${path_tail_first_char} "/" no_leading_slash)
    IF (${no_ending_slash} AND ${no_leading_slash})
        set(path_head "${path_head}/")
    ENDIF (${no_ending_slash} AND ${no_leading_slash})
    STRING(CONCAT full_path ${path_head} ${path_tail})
    set(${result} ${full_path} PARENT_SCOPE)
endfunction()
